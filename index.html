<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tank Game!</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      background: #23272e;
    }
    .title {
      text-align: center;
      margin-top: 0;
      padding-top: 20px;
      background: linear-gradient(90deg, #000 20%, #4e9af1 50%, #fff 80%);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-family: 'Press Start 2P', cursive;
      font-size: 2.5rem;
      letter-spacing: 2px;
      text-shadow: 0 2px 8px #0008;
    }
    button {
      display: block;
      margin: 20px auto;
      padding: 10px 20px;
      font-size: 16px;
      background-color: #000000;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-family: 'Press Start 2P', cursive;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 2px 8px #0005;
      transition: background 0.2s;
    }
    button:hover {
      background: #222;
    }
    .game-container {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      background: #23272e;
    }
    .game-bg {
      position: absolute;
      left: 0; top: 0;
      width: 100vw;
      height: 100vh;
      object-fit: contain;
      object-position: center center;
      z-index: 0;
      opacity: 0.95;
      filter: blur(0.5px) brightness(1.05);
      pointer-events: none;
    }
    #player1, #player2 {
      width: 100px;
      height: 100px;
      position: absolute;
      transition: left 0.08s linear, top 0.08s linear, transform 0.12s cubic-bezier(.4,2,.6,1);
      filter: drop-shadow(0 6px 12px rgba(0,0,0,0.3));
      will-change: left, top, transform;
      z-index: 2;
    }
    .bullet {
      width: 14px;
      height: 14px;
      background: radial-gradient(circle at 40% 40%, #eee 70%, #888 100%);
      position: absolute;
      border-radius: 50%;
      box-shadow: 0 2px 8px #0007;
      z-index: 3;
      pointer-events: none;
      transition: left 0.04s linear, top 0.04s linear;
    }
    .health-bar {
      position: absolute;
      width: 60px;
      height: 10px;
      background: #333;
      border: 2px solid #111;
      border-radius: 6px;
      top: 0;
      left: 0;
      z-index: 10;
      overflow: hidden;
    }
    .health-inner {
      height: 100%;
      background: linear-gradient(90deg, #4caf50, #a2ff4d);
      width: 100%;
      transition: width 0.2s;
    }
    .revive-cross {
  position: absolute;
  width: 40px;
  height: 40px;
  z-index: 20;
  display: none;
  pointer-events: none;
  border: 4px solid black;
  border-radius: 8px;
  box-shadow: 0 0 24px 8px #000, 0 0 16px 4px #ffe066;
  object-fit: cover;
}
  </style>
</head>
<body>
  <h1 class="title" id="gameTitle">Tankgame!</h1>
  <button id="startBtn" onclick="startGame()">Start the tank game</button>
  <div id="gameRoot"></div>
  <script>
    function startGame() {
      // Hide the title and button
      document.getElementById('gameTitle').style.display = 'none';
      document.getElementById('startBtn').style.display = 'none';

      document.getElementById('gameRoot').innerHTML = `
      <div class="game-container" id="gameContainer">
        <img src="sr5z2ff1002c5caws3.png" alt="Game Screen" class="game-bg">
        <div class="health-bar" id="healthBar1"><div class="health-inner" id="healthInner1"></div></div>
        <img id="player1" src="p1.png" alt="Player 1">
        <div class="health-bar" id="healthBar2"><div class="health-inner" id="healthInner2"></div></div>
        <img id="player2" src="pixil-frame-0 (1).png" alt="Player 2">
        <img id="cross1" class="revive-cross" src="revive.jpg" style="display:none" alt="Revive">
        <img id="cross2" class="revive-cross" src="revive.jpg" style="display:none" alt="Revive">
      </div>
    `;
      const gameContainer = document.getElementById('gameContainer');
      const player1 = document.getElementById('player1');
      const player2 = document.getElementById('player2');
      const healthBar1 = document.getElementById('healthBar1');
      const healthBar2 = document.getElementById('healthBar2');
      const healthInner1 = document.getElementById('healthInner1');
      const healthInner2 = document.getElementById('healthInner2');
      const cross1 = document.getElementById('cross1');
      const cross2 = document.getElementById('cross2');

      let x1 = 850, y1 = 750, rotation1 = 0, health1 = 100, dead1 = false;
      let x2 = 750, y2 = 750, rotation2 = 0, health2 = 100, dead2 = false;

      const step = 5;
      const keys = {};
      const bullets = [];

      player1.style.left = x1 + 'px';
      player1.style.top = y1 + 'px';
      player2.style.left = x2 + 'px';
      player2.style.top = y2 + 'px';

      document.addEventListener('keydown', (event) => {
        keys[event.key] = true;
      });
      document.addEventListener('keyup', (event) => {
        keys[event.key] = false;
      });

      // Prevent blue highlight and default behavior on click
      gameContainer.addEventListener('mousedown', (e) => {
        e.preventDefault();
        if (!dead1) shootBullet(x1, y1, rotation1, 'p1');
      });

      document.addEventListener('keydown', (event) => {
        if (event.key === ' ' && !dead2) {
          shootBullet(x2, y2, rotation2, 'p2');
        }
      });

      function shootBullet(x, y, rotation, player) {
        const bullet = document.createElement('div');
        bullet.className = 'bullet';
        bullet.setAttribute('data-owner', player);
        bullet.style.left = `${x + 43}px`;
        bullet.style.top = `${y + 43}px`;
        gameContainer.appendChild(bullet);

        let angle;
        if (player === 'p1') {
          angle = (rotation - 90 + 180) * (Math.PI / 180);
        } else {
          angle = (rotation - 90) * (Math.PI / 180);
        }
        const speed = 13;
        let bulletX = x + 50;
        let bulletY = y + 50;

        bullets.push({el: bullet, x: bulletX, y: bulletY, angle, speed, owner: player});
      }

      function rectsOverlap(ax, ay, aw, ah, bx, by, bw, bh) {
        return ax < bx + bw && ax + aw > bx && ay < by + bh && ay + ah > by;
      }

      function update() {
        if (!dead1) {
          if (keys['ArrowUp']) {
            y1 -= step;
            rotation1 = -180;
          }
          if (keys['ArrowDown']) {
            y1 += step;
            rotation1 = 0;
          }
          if (keys['ArrowLeft']) {
            x1 -= step;
            rotation1 = -270;
          }
          if (keys['ArrowRight']) {
            x1 += step;
            rotation1 = 270;
          }
        }
        if (!dead2) {
          if (keys['w']) {
            y2 -= step;
            rotation2 = 0;
          }
          if (keys['s']) {
            y2 += step;
            rotation2 = 180;
          }
          if (keys['a']) {
            x2 -= step;
            rotation2 = 270;
          }
          if (keys['d']) {
            x2 += step;
            rotation2 = -270;
          }
        }

        x1 = Math.max(0, Math.min(window.innerWidth - 100, x1));
        y1 = Math.max(0, Math.min(window.innerHeight - 100, y1));
        x2 = Math.max(0, Math.min(window.innerWidth - 100, x2));
        y2 = Math.max(0, Math.min(window.innerHeight - 100, y2));

        player1.style.left = x1 + 'px';
        player1.style.top = y1 + 'px';
        player1.style.transform = `rotate(${rotation1}deg)`;
        player1.style.display = dead1 ? 'none' : '';

        player2.style.left = x2 + 'px';
        player2.style.top = y2 + 'px';
        player2.style.transform = `rotate(${rotation2}deg)`;
        player2.style.display = dead2 ? 'none' : '';

        healthBar1.style.left = (x1 + 20) + 'px';
        healthBar1.style.top = (y1 - 18) + 'px';
        healthInner1.style.width = Math.max(0, health1) + '%';
        healthBar1.style.display = dead1 ? 'none' : '';

        healthBar2.style.left = (x2 + 20) + 'px';
        healthBar2.style.top = (y2 - 18) + 'px';
        healthInner2.style.width = Math.max(0, health2) + '%';
        healthBar2.style.display = dead2 ? 'none' : '';

        // Show/hide and position the cross (revive image)
        if (dead1) {
          cross1.style.display = '';
          cross1.style.left = (x1 + 30) + 'px';
          cross1.style.top = (y1 + 30) + 'px';
        } else {
          cross1.style.display = 'none';
        }
        if (dead2) {
          cross2.style.display = '';
          cross2.style.left = (x2 + 30) + 'px';
          cross2.style.top = (y2 + 30) + 'px';
        } else {
          cross2.style.display = 'none';
        }

        // --- REVIVE BY TOUCHING THE IMAGE ---
        // If player 1 is dead, check if player 2 touches the revive image
        if (dead1 && !dead2 &&
            rectsOverlap(x2, y2, 100, 100, x1 + 30, y1 + 30, 40, 40)) {
          health1 = 100;
          dead1 = false;
        }
        // If player 2 is dead, check if player 1 touches the revive image
        if (dead2 && !dead1 &&
            rectsOverlap(x1, y1, 100, 100, x2 + 30, y2 + 30, 40, 40)) {
          health2 = 100;
          dead2 = false;
        }

        // --- Bullets only do damage, not revive ---
        for (let i = bullets.length - 1; i >= 0; i--) {
          const b = bullets[i];
          b.x += Math.cos(b.angle) * b.speed;
          b.y += Math.sin(b.angle) * b.speed;
          b.el.style.left = `${b.x}px`;
          b.el.style.top = `${b.y}px`;

          if (
            b.owner === 'p2' &&
            !dead1 &&
            rectsOverlap(b.x, b.y, 14, 14, x1, y1, 100, 100) &&
            health1 > 0
          ) {
            health1 -= 5;
            b.el.remove();
            bullets.splice(i, 1);
            if (health1 <= 0) {
              dead1 = true;
            }
            continue;
          }
          if (
            b.owner === 'p1' &&
            !dead2 &&
            rectsOverlap(b.x, b.y, 14, 14, x2, y2, 100, 100) &&
            health2 > 0
          ) {
            health2 -= 5;
            b.el.remove();
            bullets.splice(i, 1);
            if (health2 <= 0) {
              dead2 = true;
            }
            continue;
          }
          if (
            b.x < -20 || b.x > window.innerWidth + 20 ||
            b.y < -20 || b.y > window.innerHeight + 20
          ) {
            b.el.remove();
            bullets.splice(i, 1);
          }
        }

        requestAnimationFrame(update);
      }
      update();
    }
  </script>
</body>
</html>